(this.define||function(e){"use strict";var r="CssParserJs",t=e("undefined"==typeof require?function(){}:require);"undefined"!=typeof module&&module.exports?module.exports=t:this[r]=t}).call(this,function(){"use strict";var e,r,t,n,a,o,i;return e={Comment:0,CloseBrace:1,OpenBrace:2,SemiColon:3,SelectorOrStyleProperty:4,StylePropertyColon:5,Value:6,Whitespace:7,GetNameFor:function(r){var t;for(t in e)if(e.hasOwnProperty(t)&&e[t]===r)return t;throw new Error("Invalid CharacterCategorisationOptions: "+r)}},r=function(e,r){this.message=e,this.indexInSource=r},r.prototype=new Error,r.prototype.constructor=r,r.prototype.name="ParseError",t=function(){var r,t,n,a,o,i,c,s,u,C;return r=function(e,r){return{CharacterCategorisation:e,NextProcessor:r}},t=function(e,t){return{Process:function(){return r(e,t)}}},n=function(n){var a={Process:function(o){return o.DoesCurrentContentMatch("\r\n")?r(e.Comment,t(e.Comment,n)):"\r"===o.CurrentCharacter||"\n"===o.CurrentCharacter?r(e.Comment,n):r(e.Comment,a)}};return a},a=function(n){var a={Process:function(o){return o.DoesCurrentContentMatch("*/")?r(e.Comment,t(e.Comment,n)):r(e.Comment,a)}};return a},o=function(t){var n={Process:function(a){return"{"===a.CurrentCharacter?r(e.OpenBrace,t):a.IsWhitespace?r(e.Whitespace,n):r(e.SelectorOrStyleProperty,n)}};return n},i=function(e,n,a){var o={Process:function(i){return"\\"===i.CurrentCharacter?r(n,t(n,o)):i.CurrentCharacter===e?r(n,a):r(n,o)}};return o},c=["lang","link","after","focus","hover","active","before","visited","first-line","first-child","first-letter"],s=function(e){for(;e.IsWhitespace;)e=e.GetNext();return c.some(function(r){return e.DoesCurrentContentMatch(r)})},u=function(r,t,n){var a={EndOfBehaviourOverrideCharacter:t,CharacterCategorisation:e.SelectorOrStyleProperty,CharacterProcessorToReturnTo:n};return C(!1,r,a)},C=function(t,c,h){function l(){return t?C(!1,c,null):f}function g(){return t?f:C(!0,c,null)}var f;return f={Process:function(C){var p,d;if(h&&C.CurrentCharacter===h.EndOfBehaviourOverrideCharacter)return r(h.CharacterCategorisation,h.CharacterProcessorToReturnTo);if("{"===C.CurrentCharacter)return h?r(h.CharacterCategorisation,f):r(e.OpenBrace,l());if("}"===C.CurrentCharacter)return h?r(h.CharacterCategorisation,f):r(e.CloseBrace,l());if(";"===C.CurrentCharacter)return h?r(h.CharacterCategorisation,f):r(e.SemiColon,l());if(":"===C.CurrentCharacter)return h?r(h.CharacterCategorisation,f):!t&&s(C.GetNext())?r(e.SelectorOrStyleProperty,l()):r(e.StylePropertyColon,g());if(C.IsWhitespace)return h?r(h.CharacterCategorisation,f):r(e.Whitespace,f);if("/"===C.CurrentCharacter){if(p=C.GetNext().CurrentCharacter,c&&"/"===p)return r(e.Comment,n(f));if("*"===p)return r(e.Comment,a(f))}return!t&&C.DoesCurrentContentMatch("@media")?r(e.SelectorOrStyleProperty,o(f)):'"'===C.CurrentCharacter||"'"===C.CurrentCharacter?h?r(h.CharacterCategorisation,i(C.CurrentCharacter,h.CharacterCategorisation,f)):r(e.Value,i(C.CurrentCharacter,e.Value,g())):!t&&(d="["===C.CurrentCharacter?"]":"("===C.CurrentCharacter?")":null)?r(e.SelectorOrStyleProperty,u(c,d,f)):r(t?e.Value:e.SelectorOrStyleProperty,f)}}},{GetNewCssProcessor:function(){return C(!1,!1,null)},GetNewLessProcessor:function(){return C(!1,!0,null)}}}(),n=function(e,r){var t=r>=e.length,a={CurrentCharacter:t?null:e.charAt(r),IsWhitespace:t?!1:/\s/.test(e.charAt(r)),DoesCurrentContentMatch:function(t){return t?e.substr(r,t.length)===t:!1}};return a.GetNext=t?function(){return a}:function(){return n(e,r+1)},a},a=function(e,r){for(var t,a=[],o=n(r,0);o.CurrentCharacter;)t=e.Process(o),a.push({Character:o.CurrentCharacter,CharacterCategorisation:t.CharacterCategorisation}),o=o.GetNext(),e=t.NextProcessor;return a},o=function(r){var t=[],n={CharacterCategorisation:null,Characters:[],IndexInSource:null};return r.forEach(function(r,a){var o=r.CharacterCategorisation===e.CloseBrace||r.CharacterCategorisation===e.OpenBrace||r.CharacterCategorisation===e.SemiColon;return r.CharacterCategorisation!==n.CharacterCategorisation||o?(n.Characters.length>0&&t.push({CharacterCategorisation:n.CharacterCategorisation,Value:n.Characters.join(""),IndexInSource:n.IndexInSource}),void(o?(t.push({CharacterCategorisation:r.CharacterCategorisation,Value:r.Character,IndexInSource:a}),n={CharacterCategorisation:null,Characters:[],IndexInSource:null}):n={CharacterCategorisation:r.CharacterCategorisation,Characters:[r.Character],IndexInSource:a})):void n.Characters.push(r.Character)}),n.Characters.length>0&&t.push({CharacterCategorisation:n.CharacterCategorisation,Value:n.Characters.join(""),IndexInSource:n.IndexInSource}),t},i={CharacterCategorisationOptions:e,ParseError:r,ParseCss:function(e){return o(a(t.GetNewCssProcessor(),e))},ParseLess:function(e){return o(a(t.GetNewLessProcessor(),e))}},function(){var e,t,n;e=function(){var e,t,n,a,o;return e={EndOfSelector:0,EndOfSelectorSegment:1,SelectorSegment:2},t=function(e,r){return{CharacterCategorisation:e,NextProcessor:r}},n=function(){var r={Process:function(n){return/\s/.test(n)?t(e.EndOfSelectorSegment,r):","===n?t(e.EndOfSelector,r):"["===n?t(e.SelectorSegment,a(r)):t(e.SelectorSegment,r)}};return r},a=function(r){var n={Process:function(a){return'"'===a||"'"===a?t(e.SelectorSegment,o(n,a,!1)):"]"===a?t(e.SelectorSegment,r):t(e.SelectorSegment,n)}};return n},o=function(r,n,a){var i={Process:function(c){return a?t(e.SelectorSegment,o(i,c,!1)):c===n?t(e.SelectorSegment,r):t(e.SelectorSegment,i)}};return i},{Break:function(a){var o,i=[],c=[],s=[],u=n();return a.split("").concat([" "]).forEach(function(n,C){if(o=C===a.length?t(e.EndOfSelector,u):u.Process(n),o.CharacterCategorisation===e.SelectorSegment)s.push(n);else if(o.CharacterCategorisation===e.EndOfSelectorSegment)s.length>0&&(c.push(s.join("")),s=[]);else{if(o.CharacterCategorisation!==e.EndOfSelector)throw new r("Unsupported CharacterCategorisationOptions: "+o.CharacterCategorisation,C);s.length>0&&(c.push(s.join("")),s=[]),c.length>0&&(i.push(c),c=[])}u=o.NextProcessor}),i}}}(),t=function(){var t,a,o,c,s,u;return t=function(e){var r=-1;return{GetCurrent:function(){return 0>r||r>=e.length?null:e[r]},MoveNext:function(){return r<e.length&&(r+=1),r<e.length}}},a=function(){var e=null;return{Add:function(r,t,a){e?e.Values.push(t):e={FragmentCategorisation:n.StylePropertyValue,Property:r,Values:[t],SourceLineIndex:a}},GetHasContent:function(){return!!e},ExtractCombinedContentAndClear:function(){if(!e)throw new Error("No content to retrieve");var r=e;return e=null,r}}},o=function(r){var t=e.Break(r),n=[];return t.forEach(function(e){n.push(e.join(" "))}),n},c=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},s=function(e){return-1===e.indexOf("\r")&&-1===e.indexOf("\n")?0:e.match(/\r\n|\r|\n/g).length},u=function(e,t,C,h){for(var l,g,f,p,d=h,m=[],S=[],P=-1,I=null,x=a();e.MoveNext();)switch(l=e.GetCurrent(),l.CharacterCategorisation){case i.CharacterCategorisationOptions.Comment:m.push({FragmentCategorisation:n.Comment,Value:l.Value,SourceLineIndex:h}),h+=s(l.Value);break;case i.CharacterCategorisationOptions.Whitespace:S.length>0&&S.push(" "),h+=s(l.Value);break;case i.CharacterCategorisationOptions.SelectorOrStyleProperty:0===S.length&&(P=h),S.push(l.Value),x.GetHasContent()&&m.push(x.ExtractCombinedContentAndClear());break;case i.CharacterCategorisationOptions.OpenBrace:if(0===S.length)throw new r("Encountered OpenBrace with no preceding selector at line "+(h+1),l.IndexInSource);if(x.GetHasContent()&&m.push(x.ExtractCombinedContentAndClear()),g=o(S.join("")),0===g.length)throw new r("Open brace encountered with no leading selector content at line "+(h+1),l.IndexInSource);f=u(e,t.concat([g]),C+1,h),m.push({FragmentCategorisation:"@media"===g[0].toLowerCase().substring(0,6)?n.MediaQuery:n.Selector,ParentSelectors:t,Selectors:g,ChildFragments:f.Fragments,SourceLineIndex:P}),h+=f.NumberOfLinesParsed,S=[];break;case i.CharacterCategorisationOptions.CloseBrace:if(0===C)throw new r("Encountered unexpected close brace (on line "+(h+1)+")",l.IndexInSource);return x.GetHasContent()&&m.push(x.ExtractCombinedContentAndClear()),S.length>0&&m.push({FragmentCategorisation:n.StylePropertyName,Value:S.join(""),SourceLineIndex:P}),{Fragments:m,NumberOfLinesParsed:h-d};case i.CharacterCategorisationOptions.StylePropertyColon:case i.CharacterCategorisationOptions.SemiColon:if(x.GetHasContent()&&m.push(x.ExtractCombinedContentAndClear()),S.length>0){if(p=S.join(""),"@import"===p.toLowerCase().substring(0,7)){m.push({FragmentCategorisation:n.Import,Value:c(p.substring(7)),SourceLineIndex:h}),S=[];break}I={FragmentCategorisation:n.StylePropertyName,Value:S.join(""),SourceLineIndex:P},m.push(I),S=[]}break;case i.CharacterCategorisationOptions.Value:if(S.length>0){if(p=S.join(""),"@import"===p.toLowerCase().substring(0,7)){S.push(l.Value);break}I={FragmentCategorisation:n.StylePropertyName,Value:S.join(""),SourceLineIndex:P},m.push(I),S=[]}if(!I)throw new r("Invalid content, orphan style property value encountered at line "+(h+1),l.IndexInSource);x.Add(I,l.Value,P);break;default:throw new r("Unsupported CharacterCategorisationOptions value: "+l.CharacterCategorisation,l.IndexInSource)}return S.length>0&&(g=o(S.join("")),m.push({FragmentCategorisation:"@media"===g[0].Value.toLowerCase().substring(0,6)?n.MediaQuery:n.Selector,ParentSelectors:t,Selectors:g,ChildFragments:[],SourceLineIndex:h})),x.GetHasContent()&&m.push(x.ExtractCombinedContentAndClear()),{Fragments:m,NumberOfLinesParsed:h-d}},{ParseIntoStructuredData:function(e){for(var n,a,o=t(e),c=u(o,[],0,0);o.MoveNext();)if(n=o.GetCurrent(),n.CharacterCategorisation!==i.CharacterCategorisationOptions.Comment&&n.CharacterCategorisation!==i.CharacterCategorisationOptions.Whitespace)throw a=c.Fragments.length>0?c.Fragments[c.Fragments.length-1].SourceLineIndex:0,new r("Encountered unexpected content (after line "+(a+1)+") - this is often caused by mismatched opening or closing braces",n.IndexInSource);return c.Fragments}}}(),n={Comment:0,Import:1,MediaQuery:2,Selector:3,StylePropertyName:4,StylePropertyValue:5,GetNameFor:function(e){var r;for(r in n)if(n.hasOwnProperty(r)&&n[r]===e)return r;throw new Error("Invalid FragmentCategorisationOptions: "+e)}},i.ExtendedLessParser={ParseIntoStructuredData:function(e){return"string"==typeof e&&(e=i.ParseLess(e)),t.ParseIntoStructuredData(e)},FragmentCategorisationOptions:n}}(),i});