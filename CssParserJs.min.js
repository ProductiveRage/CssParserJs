(this.define||function(e){"use strict";var r="CssParserJs",t=e("undefined"==typeof require?function(){}:require);"undefined"!=typeof module&&module.exports?module.exports=t:this[r]=t}).call(this,function(){"use strict";var e,r,t,n,a,o;return e={Comment:0,CloseBrace:1,OpenBrace:2,SemiColon:3,SelectorOrStyleProperty:4,StylePropertyColon:5,Value:6,Whitespace:7,GetNameFor:function(r){var t;for(t in e)if(e.hasOwnProperty(t)&&e[t]===r)return t;throw new Error("Invalid CharacterCategorisationOptions: "+r)}},r=function(){var r,t,n,a,o,s,i,c,u,C;return r=function(e,r){return{CharacterCategorisation:e,NextProcessor:r}},t=function(e,t){return{Process:function(){return r(e,t)}}},n=function(n){var a={Process:function(o){return o.DoesCurrentContentMatch("\r\n")?r(e.Comment,t(e.Comment,n)):"\r"===o.CurrentCharacter||"\n"===o.CurrentCharacter?r(e.Comment,n):r(e.Comment,a)}};return a},a=function(n){var a={Process:function(o){return o.DoesCurrentContentMatch("*/")?r(e.Comment,t(e.Comment,n)):r(e.Comment,a)}};return a},o=function(t){var n={Process:function(a){return"{"===a.CurrentCharacter?r(e.OpenBrace,t):a.IsWhitespace?r(e.Whitespace,n):r(e.SelectorOrStyleProperty,n)}};return n},s=function(e,n,a){var o={Process:function(s){return"\\"===s.CurrentCharacter?r(n,t(n,o)):s.CurrentCharacter===e?r(n,a):r(n,o)}};return o},i=["lang","link","after","focus","hover","active","before","visited","first-line","first-child","first-letter"],c=function(e){for(;e.IsWhitespace;)e=e.GetNext();return i.some(function(r){return e.DoesCurrentContentMatch(r)})},u=function(r,t,n){var a={EndOfBehaviourOverrideCharacter:t,CharacterCategorisation:e.SelectorOrStyleProperty,CharacterProcessorToReturnTo:n};return C(!1,r,a)},C=function(t,i,l){function g(){return t?C(!1,i,null):d}function h(){return t?d:C(!0,i,null)}var d;return d={Process:function(C){var p,f;if(l&&C.CurrentCharacter===l.EndOfBehaviourOverrideCharacter)return r(l.CharacterCategorisation,l.CharacterProcessorToReturnTo);if("{"===C.CurrentCharacter)return l?r(l.CharacterCategorisation,d):r(e.OpenBrace,g());if("}"===C.CurrentCharacter)return l?r(l.CharacterCategorisation,d):r(e.CloseBrace,g());if(";"===C.CurrentCharacter)return l?r(l.CharacterCategorisation,d):r(e.SemiColon,g());if(":"===C.CurrentCharacter)return l?r(l.CharacterCategorisation,d):!t&&c(C.GetNext())?r(e.SelectorOrStyleProperty,g()):r(e.StylePropertyColon,h());if(C.IsWhitespace)return l?r(l.CharacterCategorisation,d):r(e.Whitespace,d);if("/"===C.CurrentCharacter){if(p=C.GetNext().CurrentCharacter,i&&"/"===p)return r(e.Comment,n(d));if("*"===p)return r(e.Comment,a(d))}return!t&&C.DoesCurrentContentMatch("@media")?r(e.SelectorOrStyleProperty,o(d)):'"'===C.CurrentCharacter||"'"===C.CurrentCharacter?l?r(l.CharacterCategorisation,s(C.CurrentCharacter,l.CharacterCategorisation,d)):r(e.Value,s(C.CurrentCharacter,e.Value,h())):!t&&(f="["===C.CurrentCharacter?"]":"("===C.CurrentCharacter?")":null)?r(e.SelectorOrStyleProperty,u(i,f,d)):r(t?e.Value:e.SelectorOrStyleProperty,d)}}},{GetNewCssProcessor:function(){return C(!1,!1,null)},GetNewLessProcessor:function(){return C(!1,!0,null)}}}(),t=function(e,r){var n=r>=e.length,a={CurrentCharacter:n?null:e.charAt(r),IsWhitespace:n?!1:/\s/.test(e.charAt(r)),DoesCurrentContentMatch:function(t){return t?e.substr(r,t.length)===t:!1}};return a.GetNext=n?function(){return a}:function(){return t(e,r+1)},a},n=function(e,r){for(var n,a=[],o=t(r,0);o.CurrentCharacter;)n=e.Process(o),a.push({Character:o.CurrentCharacter,CharacterCategorisation:n.CharacterCategorisation}),o=o.GetNext(),e=n.NextProcessor;return a},a=function(r){var t=[],n={CharacterCategorisation:null,Characters:[],IndexInSource:null};return r.forEach(function(r,a){var o=r.CharacterCategorisation===e.CloseBrace||r.CharacterCategorisation===e.OpenBrace||r.CharacterCategorisation===e.SemiColon;return r.CharacterCategorisation!==n.CharacterCategorisation||o?(n.Characters.length>0&&t.push({CharacterCategorisation:n.CharacterCategorisation,Value:n.Characters.join(""),IndexInSource:n.IndexInSource}),void(o?(t.push({CharacterCategorisation:r.CharacterCategorisation,Value:r.Character,IndexInSource:a}),n={CharacterCategorisation:null,Characters:[],IndexInSource:null}):n={CharacterCategorisation:r.CharacterCategorisation,Characters:[r.Character],IndexInSource:a})):void n.Characters.push(r.Character)}),n.Characters.length>0&&t.push({CharacterCategorisation:n.CharacterCategorisation,Value:n.Characters.join(""),IndexInSource:n.IndexInSource}),t},o={CharacterCategorisationOptions:e,ParseCss:function(e){return a(n(r.GetNewCssProcessor(),e))},ParseLess:function(e){return a(n(r.GetNewLessProcessor(),e))}},function(){var e,r,t;e=function(){var e,r,t,n,a;return e={EndOfSelector:0,EndOfSelectorSegment:1,SelectorSegment:2},r=function(e,r){return{CharacterCategorisation:e,NextProcessor:r}},t=function(){var t={Process:function(a){return/\s/.test(a)?r(e.EndOfSelectorSegment,t):","===a?r(e.EndOfSelector,t):"["===a?r(e.SelectorSegment,n(t)):r(e.SelectorSegment,t)}};return t},n=function(t){var n={Process:function(o){return'"'===o||"'"===o?r(e.SelectorSegment,a(n,o,!1)):"]"===o?r(e.SelectorSegment,t):r(e.SelectorSegment,n)}};return n},a=function(t,n,o){var s={Process:function(i){return o?r(e.SelectorSegment,a(s,i,!1)):i===n?r(e.SelectorSegment,t):r(e.SelectorSegment,s)}};return s},{Break:function(n){var a,o=[],s=[],i=[],c=t();return n.split("").concat([" "]).forEach(function(t,u){if(a=u===n.length?r(e.EndOfSelector,c):c.Process(t),a.CharacterCategorisation===e.SelectorSegment)i.push(t);else if(a.CharacterCategorisation===e.EndOfSelectorSegment)i.length>0&&(s.push(i.join("")),i=[]);else{if(a.CharacterCategorisation!==e.EndOfSelector)throw new Error("Unsupported CharacterCategorisationOptions: "+a.CharacterCategorisation);i.length>0&&(s.push(i.join("")),i=[]),s.length>0&&(o.push(s),s=[])}c=a.NextProcessor}),o}}}(),r=function(){var r,n,a,s,i,c;return r=function(e){var r=-1;return{GetCurrent:function(){return 0>r||r>=e.length?null:e[r]},MoveNext:function(){return r<e.length&&(r+=1),r<e.length}}},n=function(){var e=null;return{Add:function(r,n,a){e?e.Values.push(n):e={FragmentCategorisation:t.StylePropertyValue,Property:r,Values:[n],SourceLineIndex:a}},GetHasContent:function(){return!!e},ExtractCombinedContentAndClear:function(){if(!e)throw new Error("No content to retrieve");var r=e;return e=null,r}}},a=function(r){var t=e.Break(r),n=[];return t.forEach(function(e){n.push(e.join(" "))}),n},s=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},i=function(e){return-1===e.indexOf("\r")&&-1===e.indexOf("\n")?0:e.match(/\r\n|\r|\n/g).length},c=function(e,r,u){for(var C,l,g,h,d=u,p=[],f=[],m=-1,S=null,P=n();e.MoveNext();)switch(C=e.GetCurrent(),C.CharacterCategorisation){case o.CharacterCategorisationOptions.Comment:p.push({FragmentCategorisation:t.Comment,Value:C.Value,SourceLineIndex:u}),u+=i(C.Value);break;case o.CharacterCategorisationOptions.Whitespace:f.length>0&&f.push(" "),u+=i(C.Value);break;case o.CharacterCategorisationOptions.SelectorOrStyleProperty:0===f.length&&(m=u),f.push(C.Value),P.GetHasContent()&&p.push(P.ExtractCombinedContentAndClear());break;case o.CharacterCategorisationOptions.OpenBrace:if(0===f.length)throw new Error("Encountered OpenBrace with no preceding selector at line "+(u+1));if(P.GetHasContent()&&p.push(P.ExtractCombinedContentAndClear()),l=a(f.join("")),0===l.length)throw new Error("Open brace encountered with no leading selector content at line "+(u+1));g=c(e,r.concat([l]),u),p.push({FragmentCategorisation:"@media"===l[0].toLowerCase().substring(0,6)?t.MediaQuery:t.Selector,ParentSelectors:r,Selectors:l,ChildFragments:g.Fragments,SourceLineIndex:m}),u+=g.NumberOfLinesParsed,f=[];break;case o.CharacterCategorisationOptions.CloseBrace:return P.GetHasContent()&&p.push(P.ExtractCombinedContentAndClear()),f.length>0&&p.push({FragmentCategorisation:t.StylePropertyName,Value:f.join(""),SourceLineIndex:m}),{Fragments:p,NumberOfLinesParsed:u-d};case o.CharacterCategorisationOptions.StylePropertyColon:case o.CharacterCategorisationOptions.SemiColon:if(P.GetHasContent()&&p.push(P.ExtractCombinedContentAndClear()),f.length>0){if(h=f.join(""),"@import"===h.toLowerCase().substring(0,7)){p.push({FragmentCategorisation:t.Import,Value:s(h.substring(7)),SourceLineIndex:u}),f=[];break}S={FragmentCategorisation:t.StylePropertyName,Value:f.join(""),SourceLineIndex:m},p.push(S),f=[]}break;case o.CharacterCategorisationOptions.Value:if(f.length>0){if(h=f.join(""),"@import"===h.toLowerCase().substring(0,7)){f.push(C.Value);break}S={FragmentCategorisation:t.StylePropertyName,Value:f.join(""),SourceLineIndex:m},p.push(S),f=[]}if(!S)throw new Error("Invalid content, orphan style property value encountered at line "+(u+1));P.Add(S,C.Value,m);break;default:throw new Error("Unsupported CharacterCategorisationOptions value: "+C.CharacterCategorisation)}if(f.length>0){if(l=a(f.join("")),0===l.length)throw new Error("Open brace encountered with no leading selector content at line "+(u+1));p.push({FragmentCategorisation:"@media"===l[0].Value.toLowerCase().substring(0,6)?t.MediaQuery:t.Selector,ParentSelectors:r,Selectors:l,ChildFragments:[],SourceLineIndex:u})}return P.GetHasContent()&&p.push(P.ExtractCombinedContentAndClear()),{Fragments:p,NumberOfLinesParsed:u-d}},{ParseIntoStructuredData:function(e){for(var t,n,a=r(e),s=c(a,[],0);a.MoveNext();)if(t=a.GetCurrent(),t.CharacterCategorisation!==o.CharacterCategorisationOptions.Comment&&t.CharacterCategorisation!==o.CharacterCategorisationOptions.Whitespace)throw n=s.Fragments.length>0?s.Fragments[s.Fragments.length-1].SouceLineIndex:0,new Error("Encountered unparsable data, this indicates content (after line "+(n+1)+")");return s.Fragments}}}(),t={Comment:0,Import:1,MediaQuery:2,Selector:3,StylePropertyName:4,StylePropertyValue:5,GetNameFor:function(e){var r;for(r in t)if(t.hasOwnProperty(r)&&t[r]===e)return r;throw new Error("Invalid FragmentCategorisationOptions: "+e)}},o.ExtendedLessParser={ParseIntoStructuredData:function(e){return"string"==typeof e&&(e=o.ParseLess(e)),r.ParseIntoStructuredData(e)},FragmentCategorisationOptions:t}}(),o});