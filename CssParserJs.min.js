(function(){"use strict";var r,e,t,a,n,o;r={Comment:0,CloseBrace:1,OpenBrace:2,SemiColon:3,SelectorOrStyleProperty:4,StylePropertyColon:5,Value:6,Whitespace:7,GetNameFor:function(e){var t;for(t in r)if(r.hasOwnProperty(t)&&r[t]===e)return t;throw new Error("Invalid CharacterCategorisationOptions: "+e)}},e=function(){var e,t,a,n,o,C,c,i,s,u;return e=function(r,e){return{CharacterCategorisation:r,NextProcessor:e}},t=function(r,t){return{Process:function(){return e(r,t)}}},a=function(a){var n={Process:function(o){return o.DoesCurrentContentMatch("\r\n")?e(r.Comment,t(r.Comment,a)):"\r"===o.CurrentCharacter||"\n"===o.CurrentCharacter?e(r.Comment,a):e(r.Comment,n)}};return n},n=function(a){var n={Process:function(o){return o.DoesCurrentContentMatch("*/")?e(r.Comment,t(r.Comment,a)):e(r.Comment,n)}};return n},o=function(t){var a={Process:function(n){return"{"===n.CurrentCharacter?e(r.OpenBrace,t):n.IsWhitespace?e(r.Whitespace,a):e(r.SelectorOrStyleProperty,a)}};return a},C=function(r,a,n){var o={Process:function(C){return"\\"===C.CurrentCharacter?e(a,t(a,o)):C.CurrentCharacter===r?e(a,n):e(a,o)}};return o},c=["lang","link","after","focus","hover","active","before","visited","first-line","first-child","first-letter"],i=function(r){for(var e;r.IsWhitespace;)r=r.GetNext();for(e=0;e<c.length;e++)if(r.DoesCurrentContentMatch(c[e]))return!0;return!1},s=function(e,t,a){var n={EndOfBehaviourOverrideCharacter:t,CharacterCategorisation:r.SelectorOrStyleProperty,CharacterProcessorToReturnTo:a};return u(!1,e,n)},u=function(t,c,h){function l(){return t?u(!1,c,null):g}function f(){return t?g:u(!0,c,null)}var g;return g={Process:function(u){var P,p;if(h&&u.CurrentCharacter===h.EndOfBehaviourOverrideCharacter)return e(h.CharacterCategorisation,h.CharacterProcessorToReturnTo);if("{"===u.CurrentCharacter)return h?e(h.CharacterCategorisation,g):e(r.OpenBrace,l());if("}"===u.CurrentCharacter)return h?e(h.CharacterCategorisation,g):e(r.CloseBrace,l());if(";"===u.CurrentCharacter)return h?e(h.CharacterCategorisation,g):e(r.SemiColon,l());if(":"===u.CurrentCharacter)return h?e(h.CharacterCategorisation,g):!t&&i(u.GetNext())?e(r.SelectorOrStyleProperty,l()):e(r.StylePropertyColon,f());if(u.IsWhitespace)return h?e(h.CharacterCategorisation,g):e(r.Whitespace,g);if("/"===u.CurrentCharacter){if(P=u.GetNext().CurrentCharacter,c&&"/"===P)return e(r.Comment,a(g));if("*"===P)return e(r.Comment,n(g))}return!t&&u.DoesCurrentContentMatch("@media")?e(r.SelectorOrStyleProperty,o(g)):'"'===u.CurrentCharacter||"'"===u.CurrentCharacter?h?e(h.CharacterCategorisation,C(u.CurrentCharacter,h.CharacterCategorisation,g)):e(r.Value,C(u.CurrentCharacter,r.Value,f())):!t&&(p="["===u.CurrentCharacter?"]":"("===u.CurrentCharacter?")":null)?e(r.SelectorOrStyleProperty,s(c,p,g)):e(t?r.Value:r.SelectorOrStyleProperty,g)}}},{GetNewCssProcessor:function(){return u(!1,!1,null)},GetNewLessProcessor:function(){return u(!1,!0,null)}}}(),t=function(r,e){var a=e>=r.length,n={CurrentCharacter:a?null:r.charAt(e),IsWhitespace:a?!1:/\s/.test(r.charAt(e)),DoesCurrentContentMatch:function(t){return t?r.substr(e,t.length)===t:!1}};return n.GetNext=a?function(){return n}:function(){return t(r,e+1)},n},a=function(r,e){for(var a,n=[],o=t(e,0);o.CurrentCharacter;)a=r.Process(o),n.push({Character:o.CurrentCharacter,CharacterCategorisation:a.CharacterCategorisation}),o=o.GetNext(),r=a.NextProcessor;return n},n=function(e){var t,a,n,o=[],C={CharacterCategorisation:null,Characters:[],IndexInSource:null};for(t=0;t<e.length;t++)a=e[t],n=a.CharacterCategorisation===r.CloseBrace||a.CharacterCategorisation===r.OpenBrace||a.CharacterCategorisation===r.SemiColon,a.CharacterCategorisation!==C.CharacterCategorisation||n?(C.Characters.length>0&&o.push({CharacterCategorisation:C.CharacterCategorisation,Value:C.Characters.join(""),IndexInSource:C.IndexInSource}),n?(o.push({CharacterCategorisation:a.CharacterCategorisation,Value:a.Character,IndexInSource:t}),C={CharacterCategorisation:null,Characters:[],IndexInSource:null}):C={CharacterCategorisation:a.CharacterCategorisation,Characters:[a.Character],IndexInSource:t}):C.Characters.push(a.Character);return C.Characters.length>0&&o.push({CharacterCategorisation:C.CharacterCategorisation,Value:C.Characters.join(""),IndexInSource:C.IndexInSource}),o},this.CssParserJs=o={CharacterCategorisationOptions:r,ParseCss:function(r){return n(a(e.GetNewCssProcessor(),r))},ParseLess:function(r){return n(a(e.GetNewLessProcessor(),r))}}}).call(this);